<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Love Timeline</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #fff0f5;
      color: #333;
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      color: #d63384;
      margin-bottom: 1rem;
      text-align: center;
    }
    #addButton {
      font-size: 4rem;
      color: #d63384;
      cursor: pointer;
      user-select: none;
      border: 3px dashed #d63384;
      border-radius: 50%;
      width: 80px;
      height: 80px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 1rem;
      transition: background 0.3s ease;
    }
    #addButton:hover {
      background: #f8d7e4;
    }
    #eventForm {
      background: #fff;
      border: 2px solid #d63384;
      border-radius: 1rem;
      padding: 1rem 1.5rem;
      max-width: 400px;
      width: 100%;
      margin-bottom: 2rem;
      display: none;
      flex-direction: column;
    }
    #eventForm input[type="text"],
    #eventForm input[type="date"] {
      font-size: 1rem;
      padding: 0.5rem;
      margin-bottom: 1rem;
      border-radius: 0.5rem;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
    }
    #eventForm button {
      background: #d63384;
      color: white;
      border: none;
      border-radius: 0.5rem;
      padding: 0.7rem;
      font-size: 1rem;
      cursor: pointer;
    }
    #eventForm button:disabled {
      background: #eaa6c0;
      cursor: default;
    }
    .event-month-group {
      margin-bottom: 2rem;
    }
    .event-month-header {
      font-weight: bold;
      color: #d63384;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }
    .event-card {
      position: relative;
      background: #fff;
      border: 2px solid #d63384;
      border-radius: 1rem;
      padding: 1rem 1.5rem 1.5rem 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      text-align: center;
    }
    .event-info {
      margin-bottom: 0.5rem;
    }
    .event-name {
      font-weight: bold;
      color: #d63384;
      margin-bottom: 0.3rem;
      font-size: 1.2rem;
    }
    .event-date {
      font-size: 1rem;
      color: #666;
    }
    .event-timer {
      font-size: 1rem;
      margin-top: 0.7rem;
      color: #555;
    }
    .delete-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: transparent;
      border: none;
      color: #d63384;
      font-size: 1.2rem;
      cursor: pointer;
      user-select: none;
      line-height: 1;
      padding: 0;
    }
    .delete-btn:hover {
      color: #a02862;
    }
    .sidebar-link {
      cursor: pointer;
      color: #555;
      margin: 0.2rem 0;
      padding: 2px 6px;
      border-radius: 4px;
      display: block;
      font-size: 0.9rem;
      text-align: right;
    }
    .sidebar-link:hover {
      background-color: #ffe0ef;
      color: #d63384;
    }
    .timeline-container {
      display: flex;
      justify-content: center;
      width: 100%;
      max-width: 900px;
      gap: 2rem;
    }
    #eventsList {
      flex: 3;
      padding-right: 1rem;
    }
    #sidebar {
      flex: 1;
      max-width: 150px;
      position: sticky;
      top: 1rem;
      align-self: flex-start;
    }
  </style>
</head>
<body>

<h1>ðŸ’• Our Love Timeline</h1>

<div id="addButton" title="Add a new event">ï¼‹</div>

<form id="eventForm" aria-label="Add a new event">
  <input type="text" id="eventName" placeholder="Event name (e.g. 'Together Since')" required />
  <input type="date" id="eventDate" required />
  <button type="submit" disabled>Add Event</button>
</form>

<div class="timeline-container">
  <div id="eventsList"></div>
  <div id="sidebar"></div>
</div>

<script>
  const addButton = document.getElementById('addButton');
  const eventForm = document.getElementById('eventForm');
  const eventNameInput = document.getElementById('eventName');
  const eventDateInput = document.getElementById('eventDate');
  const submitBtn = eventForm.querySelector('button');
  const eventsList = document.getElementById('eventsList');

  let events = [];

  addButton.addEventListener('click', () => {
    addButton.style.display = 'none';
    eventForm.style.display = 'flex';
    eventNameInput.focus();
  });

  function checkInputs() {
    submitBtn.disabled = !(eventNameInput.value.trim() && eventDateInput.value);
  }

  eventNameInput.addEventListener('input', checkInputs);
  eventDateInput.addEventListener('input', checkInputs);

  function formatDateDMY(dateStr) {
    const d = new Date(dateStr + "T00:00:00");
    const day = String(d.getDate()).padStart(2, '0');
    const month = String(d.getMonth() + 1).padStart(2, '0');
    const year = d.getFullYear();
    return `${day}/${month}/${year}`;
  }

  eventForm.addEventListener('submit', e => {
    e.preventDefault();
    const name = eventNameInput.value.trim();
    const date = eventDateInput.value;
    if (!name || !date) return;

    events.push({ name, date });
    eventNameInput.value = '';
    eventDateInput.value = '';
    submitBtn.disabled = true;

    eventForm.style.display = 'none';
    addButton.style.display = 'flex';
    renderEvents();
  });

  function deleteEvent(index) {
    events.splice(index, 1);
    renderEvents();
  }

  function renderEvents() {
    eventsList.innerHTML = '';
    document.getElementById('sidebar').innerHTML = '';
    if (events.length === 0) return;

    const sortedEvents = [...events].sort((a, b) => new Date(a.date) - new Date(b.date));

    const grouped = {};

    sortedEvents.forEach(event => {
      const date = new Date(event.date);
      const key = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
      if (!grouped[key]) grouped[key] = [];
      grouped[key].push(event);
    });

    const sidebar = document.getElementById('sidebar');
    const sidebarList = document.createElement('div');

    Object.keys(grouped).forEach(key => {
      const [year, month] = key.split('-');
      const monthName = new Date(`${year}-${month}-01`).toLocaleString('default', { month: 'short' });

      const link = document.createElement('div');
      link.className = 'sidebar-link';
      link.textContent = `${monthName} ${year}`;
      link.addEventListener('click', () => {
        document.getElementById(`month-${key}`).scrollIntoView({ behavior: 'smooth' });
      });

      sidebarList.appendChild(link);
    });

    sidebar.appendChild(sidebarList);

    Object.keys(grouped).forEach((key) => {
      const [year, month] = key.split('-');
      const groupDiv = document.createElement('div');
      groupDiv.className = 'event-month-group';
      groupDiv.id = `month-${key}`;

      const header = document.createElement('div');
      header.className = 'event-month-header';
      const monthName = new Date(`${year}-${month}-01`).toLocaleString('default', { month: 'long' });
      header.textContent = `${monthName} ${year}`;

      groupDiv.appendChild(header);

      grouped[key].forEach((event, i) => {
        const card = document.createElement('div');
        card.className = 'event-card';

        const info = document.createElement('div');
        info.className = 'event-info';

        const name = document.createElement('div');
        name.className = 'event-name';
        name.textContent = event.name;

        const date = document.createElement('div');
        date.className = 'event-date';
        date.textContent = formatDateDMY(event.date);

        const timer = document.createElement('div');
        timer.className = 'event-timer';
        timer.id = `timer-${event.name}-${event.date}`;

        info.appendChild(name);
        info.appendChild(date);
        info.appendChild(timer);

        const delBtn = document.createElement('button');
        delBtn.className = 'delete-btn';
        delBtn.innerHTML = 'ðŸ—‘ï¸';
        delBtn.title = 'Delete event';
        delBtn.addEventListener('click', () => {
          const indexToDelete = events.findIndex(e => e.name === event.name && e.date === event.date);
          if (indexToDelete !== -1) deleteEvent(indexToDelete);
        });

        card.appendChild(info);
        card.appendChild(delBtn);
        groupDiv.appendChild(card);
      });

      eventsList.appendChild(groupDiv);
    });

    updateTimers();
  }

  function updateTimers() {
    const now = new Date();

    events.forEach(event => {
      const eventDate = new Date(event.date + "T00:00:00");
      let diff = now - eventDate;
      if (diff < 0) diff = 0;

      let totalSeconds = Math.floor(diff / 1000);
      const seconds = totalSeconds % 60;
      const totalMinutes = Math.floor(totalSeconds / 60);
      const minutes = totalMinutes % 60;
      const totalHours = Math.floor(totalMinutes / 60);
      const hours = totalHours % 24;
      const totalDays = Math.floor(totalHours / 24);

      const years = Math.floor(totalDays / 365.25);
      const months = Math.floor((totalDays % 365.25) / 30.44);
      const days = Math.floor((totalDays % 365.25) % 30.44);

      const text = `â³ ${years} Years ${months} Months ${days} Days ${hours} Hours ${minutes} Minutes ${seconds} Seconds`;

      const timerEl = document.getElementById(`timer-${event.name}-${event.date}`);
      if (timerEl) timerEl.textContent = text;
    });
  }

  setInterval(updateTimers, 1000);
</script>

</body>
</html>
