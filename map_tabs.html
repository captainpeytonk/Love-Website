<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Leaflet Map Debug</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
<style>
  #map { width: 100%; height: 600px; }
</style>
</head>
<body>
  <div class="tabs">
    <button onclick="loadMap('world')">World</button>
    <button onclick="loadMap('us')">USA</button>
  </div>
  <div id="map"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
<script>
  let map = L.map('map').setView([20, 0], 2);
  let geoLayer = null;

  const regionPaths = {
    world: 'countries/world.geojson',
    us: 'countries/us-states.geojson',
  };

  function loadMap(region) {
    console.log('Loading map for region:', region);
    const url = regionPaths[region];
    console.log('GeoJSON URL:', url);

    if (geoLayer) {
      console.log('Removing existing geoLayer');
      map.removeLayer(geoLayer);
    }

    fetch(url)
      .then(response => {
        if (!response.ok) throw new Error(`HTTP error ${response.status}`);
        return response.json();
      })
      .then(data => {
        console.log('GeoJSON loaded:', data);
        geoLayer = L.geoJSON(data, {
          style: {
            fillColor: '#8FB3D3',
            color: '#5F84A2',
            weight: 1,
            fillOpacity: 0.7
          },
          onEachFeature: (feat, layer) => {
            const name = feat.properties.name || feat.properties.NAME || 'Unknown';
            layer.bindTooltip(name);
            layer.on({
              mouseover: e => e.target.setStyle({ fillColor: '#FFD700', fillOpacity: 0.8, weight: 2, color: '#B8860B' }),
              mouseout: e => geoLayer.resetStyle(e.target),
              click: e => e.target.setStyle({ fillColor: '#d4af37', fillOpacity: 0.5, color: '#5F84A2' })
            });
          }
        }).addTo(map);
        map.fitBounds(geoLayer.getBounds());
      })
      .catch(e => console.error('Load error for ' + region, e));
  }

  window.onload = () => loadMap('world');
</script>
</body>
</html>
